#!/bin/bash

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3

echo "-----> Installing GLPK"

# Set the version of GLPK to install
GLPK_VERSION="5.0"

# Download the GLPK source
curl -L "https://ftp.gnu.org/gnu/glpk/glpk-$GLPK_VERSION.tar.gz" -o /tmp/glpk.tar.gz

# Extract the source
tar xzf /tmp/glpk.tar.gz -C /tmp

# Compile and install GLPK
cd /tmp/glpk-$GLPK_VERSION
./configure --prefix=$BUILD_DIR
make
make install

# Set GLPK_BIN environment variable
echo "export GLPK_BIN=$BUILD_DIR/bin" >> $ENV_DIR/GLPK_BIN

# Clean up
cd /
rm -rf /tmp/glpk-$GLPK_VERSION /tmp/glpk.tar.gz

echo "-----> GLPK installation done"
